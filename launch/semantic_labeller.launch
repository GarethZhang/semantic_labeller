<?xml version="1.0"?>
<launch>

  <arg name="online" default="false"/>
  <arg name="submap_frame" default="/kf_ref"/>
  <arg name="submap_topic" default="/lidar_keyframe_slam/kfRef_cloud"/>
  <arg name="slamMap_frame" default="map"/>
  <arg name="slamMap_topic" default="/lidar_keyframe_slam/slamMap_cloud"/>
  <arg name="velodyne_frame" default="/velodyne"/>
  <arg name="velodyne_topic" default="/velodyne_points"/>
  
  <arg name="rviz" default="true"/>
  <arg name="rviz_config" default="/home/haowei/haowei_ws/src/semantic_labeller/config/lidar.rviz"/>

  <arg name="save_to_ply" default="false"/>
  <arg name="save_dir" default="/home/haowei/Documents/data/route_A/07-26-2019/listener/"/>

  <arg name="max_distance" default="1.0"/>

  <!--  submap point cloud pre-processing params-->
  <arg name="lidar_n_lines" default="128"/>
  <arg name="r_scale" default="4.0"/>
  <arg name="h_scale" default="0.5"/>

  <arg name="alpha" default="0.0873"/> <!--  Number of segments = (2 * M_PI) / alpha-->
  <arg name="tolerance" default="0.25"/> <!--  Metric distance from the ground plane to be considered a ground point-->
  <arg name="Tm" default="0.36"/> <!--  Slopes greater than this value will be considered non-ground-->
  <arg name="Tm_small" default="0.0873"/> <!--  Slopes less than this value will be checked for being a plateau-->
  <arg name="Tb" default="100.0"/> <!--  Flat regions that are higher than this will be considered non-ground-->
  <arg name="Trmse" default="0.2"/> <!--  If the RSME of the line fit exceeds this value, it will be rejected-->
  <arg name="Tdprev" default="0.5"/> <!--  Maximum allowed distance between previous line and start of new line-->

  <!-- always make sure we are not using simulation time when running online-->
  <param unless="$(arg online)" name="/use_sim_time" value="true"/>
  <param if="$(arg online)" name="/use_sim_time" value="false"/>

  <group if="$(arg rviz)">
    <node pkg="rviz" type="rviz" name="rviz" output="screen" args=" -d $(arg rviz_config)"/>
  </group>

  <node pkg="semantic_labeller" type="semantic_labeller_node" name="semantic_labeller_node" output="screen">
    <param name="submap_frame" value="$(arg submap_frame)"/>
    <param name="submap_topic" value="$(arg submap_topic)"/>
    <param name="slamMap_frame" value="$(arg slamMap_frame)"/>
    <param name="slamMap_topic" value="$(arg slamMap_topic)"/>
    <param name="velodyne_frame" value="$(arg velodyne_frame)"/>
    <param name="velodyne_topic" value="$(arg velodyne_topic)"/>

    <param name="max_distance" type="double" value="$(arg max_distance)"/>

    <param name="lidar_n_lines" type="int" value="$(arg lidar_n_lines)"/>
    <param name="r_scale" type="double" value="$(arg r_scale)"/>
    <param name="h_scale" type="double" value="$(arg h_scale)"/>

    <param name="alpha" type="double" value="$(arg alpha)"/>
    <param name="tolerance" type="double" value="$(arg tolerance)"/>
    <param name="Tm" type="double" value="$(arg Tm)"/>
    <param name="Tm_small" type="double" value="$(arg Tm_small)"/>
    <param name="Tb" type="double" value="$(arg Tb)"/>
    <param name="Trmse" type="double" value="$(arg Trmse)"/>
    <param name="Tdprev" type="double" value="$(arg Tdprev)"/>

    <param name="save_to_ply" value="$(arg save_to_ply)"/>
    <param name="save_dir" value="$(arg save_dir)" />
  </node>

</launch>     
